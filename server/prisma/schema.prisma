generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int               @id @default(autoincrement())
  name      String            @db.VarChar(255)
  balance   Decimal           @db.Decimal(10, 2)
  checkouts Checkout[]
  purchases PurshaceHistory[]
}

model PurshaceHistory {
  id       Int      @id @default(autoincrement())
  userId   Int?
  item     String   @db.VarChar(255)
  price    Decimal  @db.Decimal(10, 2)
  quantity Int
  saleDate DateTime @default(now()) @db.DateTime(0)
  user     User?    @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "PurshaceHistory_ibfk_1")

  @@index([userId], map: "userId")
}

model Menu {
  id                Int             @id @default(autoincrement())
  item              String          @db.VarChar(255)
  price             Decimal         @db.Decimal(10, 2)
  availableQuantity Int
  checkoutItems     CheckoutItems[]
}

model Checkout {
  id        Int             @id @default(autoincrement())
  userId    Int?
  status    Checkout_status
  total     Decimal         @db.Decimal(10, 2)
  createdAt DateTime        @default(now()) @db.DateTime(0)
  updatedAt DateTime?       @updatedAt @db.DateTime(0)
  user      User?           @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "Checkout_ibfk_1")
  items     CheckoutItems[]

  @@index([userId], map: "userId")
}

model CheckoutItems {
  id         Int       @id @default(autoincrement())
  checkoutId Int?
  menuItemId Int?
  quantity   Int
  checkout   Checkout? @relation(fields: [checkoutId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "CheckoutItems_ibfk_1")
  menuItem   Menu?     @relation(fields: [menuItemId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "CheckoutItems_ibfk_2")

  @@index([checkoutId], map: "checkoutId")
  @@index([menuItemId], map: "menuItemId")
}

enum Checkout_status {
  in_progress
  completed
  abandoned
  insufficient_funds
}
